--
-- PostgreSQL database dump
--

-- Dumped from database version 9.6.1
-- Dumped by pg_dump version 9.6.1

-- Started on 2017-01-18 08:47:51

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 2204 (class 1262 OID 16393)
-- Dependencies: 2203
-- Name: Shareff; Type: COMMENT; Schema: -; Owner: postgres
--

COMMENT ON DATABASE "Shareff" IS 'Capstone design database';


--
-- TOC entry 1 (class 3079 OID 12387)
-- Name: plpgsql; Type: EXTENSION; Schema: -; Owner: 
--

CREATE EXTENSION IF NOT EXISTS plpgsql WITH SCHEMA pg_catalog;


--
-- TOC entry 2206 (class 0 OID 0)
-- Dependencies: 1
-- Name: EXTENSION plpgsql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION plpgsql IS 'PL/pgSQL procedural language';


SET search_path = public, pg_catalog;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- TOC entry 186 (class 1259 OID 16410)
-- Name: address; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE address (
    "addressId" uuid NOT NULL,
    line1 text NOT NULL,
    line2 text,
    city text NOT NULL,
    province text NOT NULL,
    "postalCode" text NOT NULL,
    "userId" uuid
);


ALTER TABLE address OWNER TO postgres;

--
-- TOC entry 2207 (class 0 OID 0)
-- Dependencies: 186
-- Name: TABLE address; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE address IS 'Stores address information for either an rental item or user';


--
-- TOC entry 191 (class 1259 OID 16500)
-- Name: booking; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE booking (
    "bookingId" uuid NOT NULL,
    "itemId" uuid NOT NULL,
    "rentRequestId" uuid NOT NULL,
    "userId" uuid,
    "startDate" date NOT NULL,
    "endDate" date NOT NULL
);


ALTER TABLE booking OWNER TO postgres;

--
-- TOC entry 192 (class 1259 OID 16520)
-- Name: conversation; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE conversation (
    id uuid NOT NULL,
    "rentRequestId" uuid NOT NULL,
    "renterId" uuid NOT NULL,
    "ownerId" uuid NOT NULL,
    "startDate" timestamp without time zone NOT NULL
);


ALTER TABLE conversation OWNER TO postgres;

--
-- TOC entry 193 (class 1259 OID 16540)
-- Name: message; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE message (
    id uuid NOT NULL,
    "senderId" uuid NOT NULL,
    "timeStamp" timestamp with time zone NOT NULL,
    content text NOT NULL,
    "conversationId" uuid NOT NULL
);


ALTER TABLE message OWNER TO postgres;

--
-- TOC entry 190 (class 1259 OID 16482)
-- Name: rentRequest; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE "rentRequest" (
    id uuid NOT NULL,
    "renterId" uuid NOT NULL,
    "itemId" uuid NOT NULL,
    "startDate" date NOT NULL,
    "endDate" date NOT NULL,
    status text NOT NULL,
    comments text,
    questions text
);


ALTER TABLE "rentRequest" OWNER TO postgres;

--
-- TOC entry 188 (class 1259 OID 16446)
-- Name: rentalItem; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE "rentalItem" (
    "itemId" uuid NOT NULL,
    title text NOT NULL,
    category json[],
    description text NOT NULL,
    price double precision NOT NULL,
    "addressId" uuid,
    "termsOfUse" text,
    "ownerId" uuid NOT NULL
);


ALTER TABLE "rentalItem" OWNER TO postgres;

--
-- TOC entry 189 (class 1259 OID 16469)
-- Name: rentalItemPhoto; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE "rentalItemPhoto" (
    "itemId" uuid NOT NULL,
    "photoUrl" text NOT NULL
);


ALTER TABLE "rentalItemPhoto" OWNER TO postgres;

--
-- TOC entry 185 (class 1259 OID 16394)
-- Name: user; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE "user" (
    "userId" uuid NOT NULL,
    "firstName" text NOT NULL,
    "lastName" text NOT NULL,
    email text NOT NULL,
    password text NOT NULL,
    "photoUrl" text,
    description text,
    "avgRating" bigint,
    "addressId" uuid
);


ALTER TABLE "user" OWNER TO postgres;

--
-- TOC entry 2208 (class 0 OID 0)
-- Dependencies: 185
-- Name: TABLE "user"; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE "user" IS 'Stores all information about registerd users of the Shareff System';


--
-- TOC entry 187 (class 1259 OID 16428)
-- Name: userReview; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE "userReview" (
    id uuid NOT NULL,
    title text,
    comment text,
    "userIdFor" uuid NOT NULL,
    "userIdFrom" uuid NOT NULL,
    rating integer NOT NULL,
    "timeStamp" timestamp with time zone NOT NULL
);


ALTER TABLE "userReview" OWNER TO postgres;

--
-- TOC entry 2191 (class 0 OID 16410)
-- Dependencies: 186
-- Data for Name: address; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY address ("addressId", line1, line2, city, province, "postalCode", "userId") FROM stdin;
\.


--
-- TOC entry 2196 (class 0 OID 16500)
-- Dependencies: 191
-- Data for Name: booking; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY booking ("bookingId", "itemId", "rentRequestId", "userId", "startDate", "endDate") FROM stdin;
\.


--
-- TOC entry 2197 (class 0 OID 16520)
-- Dependencies: 192
-- Data for Name: conversation; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY conversation (id, "rentRequestId", "renterId", "ownerId", "startDate") FROM stdin;
\.


--
-- TOC entry 2198 (class 0 OID 16540)
-- Dependencies: 193
-- Data for Name: message; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY message (id, "senderId", "timeStamp", content, "conversationId") FROM stdin;
\.


--
-- TOC entry 2195 (class 0 OID 16482)
-- Dependencies: 190
-- Data for Name: rentRequest; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY "rentRequest" (id, "renterId", "itemId", "startDate", "endDate", status, comments, questions) FROM stdin;
\.


--
-- TOC entry 2193 (class 0 OID 16446)
-- Dependencies: 188
-- Data for Name: rentalItem; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY "rentalItem" ("itemId", title, category, description, price, "addressId", "termsOfUse", "ownerId") FROM stdin;
\.


--
-- TOC entry 2194 (class 0 OID 16469)
-- Dependencies: 189
-- Data for Name: rentalItemPhoto; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY "rentalItemPhoto" ("itemId", "photoUrl") FROM stdin;
\.


--
-- TOC entry 2190 (class 0 OID 16394)
-- Dependencies: 185
-- Data for Name: user; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY "user" ("userId", "firstName", "lastName", email, password, "photoUrl", description, "avgRating", "addressId") FROM stdin;
\.


--
-- TOC entry 2192 (class 0 OID 16428)
-- Dependencies: 187
-- Data for Name: userReview; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY "userReview" (id, title, comment, "userIdFor", "userIdFrom", rating, "timeStamp") FROM stdin;
\.


--
-- TOC entry 2041 (class 2606 OID 16417)
-- Name: address address_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY address
    ADD CONSTRAINT address_pkey PRIMARY KEY ("addressId");


--
-- TOC entry 2051 (class 2606 OID 16504)
-- Name: booking booking_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY booking
    ADD CONSTRAINT booking_pkey PRIMARY KEY ("bookingId");


--
-- TOC entry 2053 (class 2606 OID 16524)
-- Name: conversation conversation_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY conversation
    ADD CONSTRAINT conversation_pkey PRIMARY KEY (id);


--
-- TOC entry 2055 (class 2606 OID 16547)
-- Name: message message_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY message
    ADD CONSTRAINT message_pkey PRIMARY KEY (id);


--
-- TOC entry 2049 (class 2606 OID 16489)
-- Name: rentRequest rentRequest_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentRequest"
    ADD CONSTRAINT "rentRequest_pkey" PRIMARY KEY (id);


--
-- TOC entry 2047 (class 2606 OID 16476)
-- Name: rentalItemPhoto rentalItemPhoto_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentalItemPhoto"
    ADD CONSTRAINT "rentalItemPhoto_pkey" PRIMARY KEY ("itemId", "photoUrl");


--
-- TOC entry 2045 (class 2606 OID 16453)
-- Name: rentalItem rentalItem_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentalItem"
    ADD CONSTRAINT "rentalItem_pkey" PRIMARY KEY ("itemId");


--
-- TOC entry 2043 (class 2606 OID 16435)
-- Name: userReview userReview_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "userReview"
    ADD CONSTRAINT "userReview_pkey" PRIMARY KEY (id);


--
-- TOC entry 2039 (class 2606 OID 16401)
-- Name: user user_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "user"
    ADD CONSTRAINT user_pkey PRIMARY KEY ("userId");


--
-- TOC entry 2060 (class 2606 OID 16454)
-- Name: rentalItem addressId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentalItem"
    ADD CONSTRAINT "addressId" FOREIGN KEY ("addressId") REFERENCES address("addressId") ON UPDATE CASCADE ON DELETE SET NULL;


--
-- TOC entry 2056 (class 2606 OID 16464)
-- Name: user addressId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "user"
    ADD CONSTRAINT "addressId" FOREIGN KEY ("addressId") REFERENCES address("addressId") ON UPDATE CASCADE ON DELETE SET NULL;


--
-- TOC entry 2072 (class 2606 OID 16553)
-- Name: message conversationId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY message
    ADD CONSTRAINT "conversationId" FOREIGN KEY ("conversationId") REFERENCES "user"("userId") ON DELETE CASCADE;


--
-- TOC entry 2062 (class 2606 OID 16477)
-- Name: rentalItemPhoto itemId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentalItemPhoto"
    ADD CONSTRAINT "itemId" FOREIGN KEY ("itemId") REFERENCES "rentalItem"("itemId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2064 (class 2606 OID 16495)
-- Name: rentRequest itemId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentRequest"
    ADD CONSTRAINT "itemId" FOREIGN KEY ("itemId") REFERENCES "rentalItem"("itemId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2065 (class 2606 OID 16505)
-- Name: booking itemId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY booking
    ADD CONSTRAINT "itemId" FOREIGN KEY ("itemId") REFERENCES "rentalItem"("itemId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2061 (class 2606 OID 16459)
-- Name: rentalItem ownerId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentalItem"
    ADD CONSTRAINT "ownerId" FOREIGN KEY ("ownerId") REFERENCES "user"("userId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2070 (class 2606 OID 16535)
-- Name: conversation ownerId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY conversation
    ADD CONSTRAINT "ownerId" FOREIGN KEY ("ownerId") REFERENCES "user"("userId") ON DELETE CASCADE;


--
-- TOC entry 2066 (class 2606 OID 16510)
-- Name: booking rentRequestId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY booking
    ADD CONSTRAINT "rentRequestId" FOREIGN KEY ("rentRequestId") REFERENCES "rentRequest"(id);


--
-- TOC entry 2068 (class 2606 OID 16525)
-- Name: conversation rentRequestId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY conversation
    ADD CONSTRAINT "rentRequestId" FOREIGN KEY ("rentRequestId") REFERENCES "rentRequest"(id);


--
-- TOC entry 2063 (class 2606 OID 16490)
-- Name: rentRequest renterId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "rentRequest"
    ADD CONSTRAINT "renterId" FOREIGN KEY ("renterId") REFERENCES "user"("userId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2069 (class 2606 OID 16530)
-- Name: conversation renterId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY conversation
    ADD CONSTRAINT "renterId" FOREIGN KEY ("renterId") REFERENCES "user"("userId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2071 (class 2606 OID 16548)
-- Name: message senderId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY message
    ADD CONSTRAINT "senderId" FOREIGN KEY ("senderId") REFERENCES "user"("userId");


--
-- TOC entry 2057 (class 2606 OID 16418)
-- Name: address userId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY address
    ADD CONSTRAINT "userId" FOREIGN KEY ("userId") REFERENCES "user"("userId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2067 (class 2606 OID 16515)
-- Name: booking userId; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY booking
    ADD CONSTRAINT "userId" FOREIGN KEY ("userId") REFERENCES "user"("userId");


--
-- TOC entry 2058 (class 2606 OID 16436)
-- Name: userReview userIdFor; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "userReview"
    ADD CONSTRAINT "userIdFor" FOREIGN KEY ("userIdFor") REFERENCES "user"("userId") ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2059 (class 2606 OID 16441)
-- Name: userReview userIdFrom; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY "userReview"
    ADD CONSTRAINT "userIdFrom" FOREIGN KEY ("userIdFrom") REFERENCES "user"("userId") ON UPDATE CASCADE ON DELETE CASCADE;


-- Completed on 2017-01-18 08:47:53

--
-- PostgreSQL database dump complete
--

